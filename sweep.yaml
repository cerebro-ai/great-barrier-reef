entity: cerebro-ai
project: great-barrier-reef
program: wandb_train.py
method: random
metric:
  goal: maximize
  name: "validation/F2 score"
parameters:
  # training run
  num_epochs:
    value: 2
  eval_every_n_epochs:
    value: 1
  save_every_n_epochs:
    value: 2
  train_num_workers:
    value: 1
  val_num_workers:
    value: 1
  upload_videos:
    value: False

  # batch size
  train_batch_size:
    values: [16, 8, 4]
  val_batch_size:
    value: 16

  # optimizer
  learning_rate:
    distribution: log_uniform
    max:  -8.11 # 3.e-4
    min: -11.51 # 1.e-5
  beta_1:
    value: 0.9 # 0.9
  beta_2:
    value: 0.999 # 0.999
  weight_decay:
    values: [0, 0.0005, 0.005] # 0

  # model
  model_name:
    value: "resnet50"
  trainable_layers:
    values: [5, 4, 3, 2]
  # --> anchor sizes
  anchor_sizes:
    values: [
      "((8, 16, 32), (16, 32, 64), (16, 32, 64), (32, 64, 128), (64, 128, 256))",
      "((16,), (32,), (64,), (128,), (256,))"
    ]

  # augmentations
  rotation_limit:
    distribution: uniform
    min: 0
    max: 90
  zoom_in:
    distribution: uniform
    min: 0.8
    max: 1
  zoom_out_1:
    distribution: uniform
    min: 0
    max: 0.3
  zoom_out_2:
    distribution: uniform
    min: 0
    max: 0.4