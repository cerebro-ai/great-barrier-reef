entity: cerebro-ai
project: great-barrier-reef
program: wandb_train.py
method: random
metric:
  goal: maximize
  name: "validation/F2 score"
parameters:
  # training run
  num_epochs:
    value: 3
  eval_every_n_epochs:
    value: 1
  save_every_n_epochs:
    value: 1
  train_num_workers:
    value: 2
  val_num_workers:
    value: 2
  skip_initial_val:
    value: True

  # batch size
  train_batch_size:
    values: [16, 12, 8, 4]
  val_batch_size:
    value: 16

  # optimizer
  learning_rate:
    values: [1.e-3, 5.e-4, 1.e-4, 5.e-5, 1.e-5, 5.e-6]
  beta_1:
    values: [0.85, 0.9, 0.95, 0.99] # 0.9
  beta_2:
    values: [0.99, 0.995, 0.999] # 0.999
  weight_decay:
    values: [0, 0.0005, 0.005]

  # model
  model_name:
    value: "resnet50"
  trainable_layers:
    values: [5, 4, 3, 2, 1]
  # --> anchor sizes
  anchor_sizes:
    values: [
      "((8, 16, 32), (16, 32, 64), (16, 32, 64), (32, 64, 128), (64, 128, 256))",
      "((16,), (32,), (64,), (128,), (256,))"
    ]

  # augmentations
  rotation_limit:
    values: [0, 5, 20, 60, 90]
  zoom_in:
    values: [0.8, 0.9, 1]
  zoom_out_1:
    values: [0, .1, .3]
  zoom_out_2:
    values: [0, .2, .4]