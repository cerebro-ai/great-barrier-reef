entity: cerebro-ai
project: great-barrier-reef
program: wandb_train.py
method: random
metric:
  goal: maximize
  name: "validation/F2 score"
parameters:
  # training run
  num_epochs:
    value: 4
  eval_every_n_epochs:
    value: 1
  save_every_n_epochs:
    value: 2
  train_num_workers:
    value: 1
  val_num_workers:
    value: 1
  upload_videos:
    value: False

  # batch size
  train_batch_size:
    value: 16
  val_batch_size:
    value: 16

  # optimizer
  optimizer:
    values: ["Adam", "SGD"]
  learning_rate:
    distribution: log_uniform
    max: -8.11 # 3.e-4
    min: -11.51 # 1.e-5
  weight_decay:
    values: [ 0, 0.0005 ] # 0
  momentum:
    values: [1, 0.9, 0.8]
  beta_1:
    value: 0.9 # 0.9
  beta_2:
    value: 0.999 # 0.999


  # model
  model_name:
    value: "yolox-m"
  nms_thresh:
    distribution: uniform
    max: 0.8
    min: 0.2
  # augmentations
  rotation_limit:
    distribution: uniform
    min: 0
    max: 90
  random_scale:
    distribution: uniform
    min: 0
    max: 0.5
  random_rain_prob:
    values: [ 0, 0.5 ]
  use_copy_paste:
    values: [ True, False ]